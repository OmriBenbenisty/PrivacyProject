# Differential Privacy in Machine Learning with VAEs

This project explores two approaches to integrating **Differential Privacy (DP)** into machine learning workflows:

1. **Training a classifier with differential privacy guarantees.**
2. **Generating a differentially private synthetic dataset** to train a classifier.

The project leverages **Variational Autoencoders (VAEs)** and the **Opacus library** to ensure privacy during training.

---

## 📜 Table of Contents

- [Introduction](#introduction)
- [Installation](#installation)
- [Usage](#usage)
- [Project Structure](#project-structure)
- [Results](#results)
- [License](#license)

---

## 📖 Introduction

In this study, we explore two approaches to integrating **differential privacy** into machine learning workflows:

1. **Training a classifier with differential privacy:** Ensures that model parameters do not leak sensitive information.
2. **Generating a differentially private synthetic dataset:** A VAE is trained with DP to generate a dataset that mimics the original distribution, allowing a classifier to be trained without privacy constraints.

We implement these approaches using:
- **[Variational Autoencoders (VAEs)](https://arxiv.org/abs/1312.6114)** for generative modeling.
- **[Opacus](https://opacus.ai/)** for privacy-preserving deep learning.

---

## ⚙️ Installation

To install the required dependencies, run:

```bash
pip install -r requirements.txt
```

---

## 🚀 Usage

To run the project, execute `train.py` or follow these steps:

### 1️⃣ Initialize Datasets and Data Loaders
```python
train_loader, test_loader = init()
```

### 2️⃣ Train the VAE with Differential Privacy
```python
train_vae(train_loader, test_loader, private=True)
```

### 3️⃣ Generate Synthetic Data using the Trained VAE
```python
private_dataset, private_labels = generate_synthetic_data_with_mean_calculation(vae, train_loader)
```

### 4️⃣ Train the Classifier on the Synthetic Dataset
```python
train_classifier(private_loader, test_loader, save_path, private=False)
```

### 5️⃣ Evaluate Results and Visualize Synthetic Data
```python
plot_synthetic_data(private_dataset, private_labels, images_per_class=5)
```

---

## 📁 Project Structure

```
.
├── data/                  # Directory for storing datasets
├── Plots/                 # Directory for storing images
├── Trained/               # Directory for storing trained models
├── VAE.py                 # VAE model definition and loss function
├── train.py               # Training and evaluation scripts
├── requirements.txt       # List of dependencies
└── README.md              # Project documentation
```

---

## 📊 Results

The results include **classifier performance** and the **quality of the synthetic data** generated by the VAE. Metrics used for evaluation:

- **Accuracy** 🏆
- **Loss** 📉
- **Privacy Budget** 🔒
- **Synthetic Data Quality** 🎨

Example images from the **synthetic dataset** and **loss graphs** can be found in the [`Plots/`](./Plots/) directory.

---

## 📜 License

This project is licensed under the **MIT License**. See the [`LICENSE`](./LICENSE) file for details.

