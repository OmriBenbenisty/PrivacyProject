# Differential Privacy in Machine Learning with VAEs

This project explores two approaches to integrating **Differential Privacy (DP)** into machine learning workflows:

1. **Training a classifier with differential privacy guarantees.**
2. **Generating a differentially private synthetic dataset** to train a classifier.

The project leverages **Variational Autoencoders (VAEs)** and the **Opacus library** to ensure privacy during training.

---

## ğŸ“œ Table of Contents

- [Introduction](#introduction)
- [Installation](#installation)
- [Usage](#usage)
- [Project Structure](#project-structure)
- [Results](#results)
- [License](#license)

---

## ğŸ“– Introduction

In this study, we explore two approaches to integrating **differential privacy** into machine learning workflows:

1. **Training a classifier with differential privacy:** Ensures that model parameters do not leak sensitive information.
2. **Generating a differentially private synthetic dataset:** A VAE is trained with DP to generate a dataset that mimics the original distribution, allowing a classifier to be trained without privacy constraints.

We implement these approaches using:
- **[Variational Autoencoders (VAEs)](https://arxiv.org/abs/1312.6114)** for generative modeling.
- **[Opacus](https://opacus.ai/)** for privacy-preserving deep learning.

---

## âš™ï¸ Installation

To install the required dependencies, run:

```bash
pip install -r requirements.txt
```

---

## ğŸš€ Usage

To run the project, execute `train.py` or follow these steps:

### 1ï¸âƒ£ Initialize Datasets and Data Loaders
```python
train_loader, test_loader = init()
```

### 2ï¸âƒ£ Train the VAE with Differential Privacy
```python
train_vae(train_loader, test_loader, private=True)
```

### 3ï¸âƒ£ Generate Synthetic Data using the Trained VAE
```python
private_dataset, private_labels = generate_synthetic_data_with_mean_calculation(vae, train_loader)
```

### 4ï¸âƒ£ Train the Classifier on the Synthetic Dataset
```python
train_classifier(private_loader, test_loader, save_path, private=False)
```

### 5ï¸âƒ£ Evaluate Results and Visualize Synthetic Data
```python
plot_synthetic_data(private_dataset, private_labels, images_per_class=5)
```

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ data/                  # Directory for storing datasets
â”œâ”€â”€ Plots/                 # Directory for storing images
â”œâ”€â”€ Trained/               # Directory for storing trained models
â”œâ”€â”€ VAE.py                 # VAE model definition and loss function
â”œâ”€â”€ train.py               # Training and evaluation scripts
â”œâ”€â”€ requirements.txt       # List of dependencies
â””â”€â”€ README.md              # Project documentation
```

---

## ğŸ“Š Results

The results include **classifier performance** and the **quality of the synthetic data** generated by the VAE. Metrics used for evaluation:

- **Accuracy** ğŸ†
- **Loss** ğŸ“‰
- **Privacy Budget** ğŸ”’
- **Synthetic Data Quality** ğŸ¨

Example images from the **synthetic dataset** and **loss graphs** can be found in the [`Plots/`](./Plots/) directory.

---

## ğŸ“œ License

This project is licensed under the **MIT License**. See the [`LICENSE`](./LICENSE) file for details.

